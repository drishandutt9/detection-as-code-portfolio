title: PowerShell Download Cradle Detection
id: 23b4c567-89de-01fg-2345-678901bcdefg
status: stable
description: Detects PowerShell download cradle techniques commonly used to download and execute malicious payloads from remote sources
author: Your Name
date: 2025/11/02
references:
    - https://attack.mitre.org/techniques/T1059/001/
    - https://attack.mitre.org/techniques/T1105/
tags:
    - attack.execution
    - attack.t1059.001
    - attack.command_and_control
    - attack.t1105
logsource:
    product: windows
    category: process_creation
detection:
    selection_webclient:
        CommandLine|contains:
            - 'System.Net.WebClient'
            - 'Net.WebClient'
            - 'DownloadString'
            - 'DownloadFile'
            - 'DownloadData'
    selection_invoke:
        CommandLine|contains:
            - 'IEX'
            - 'Invoke-Expression'
            - 'Invoke-WebRequest'
            - 'iwr'
            - 'curl'
            - 'wget'
    selection_url:
        CommandLine|re: '.*http[s]?://.*'
    selection_process:
        Image|endswith:
            - '\powershell.exe'
            - '\pwsh.exe'
    condition: selection_process and (selection_webclient or selection_invoke) and selection_url
falsepositives:
    - Legitimate software installation scripts
    - Authorized system administration tasks
    - Software update mechanisms
level: high
fields:
    - ComputerName
    - User
    - CommandLine
    - ParentImage
    - Image
